# vim ft=yaml
# travis-ci.org definition
#
# We pretend to be java because we need GNU Octave which is not
# available (as of April 2015)

language: java

cache:
  - apt
env:
 global:
    - OCTAVE=octave
before_install:
    # to prevent IPv6 being used for APT
    - sudo bash -c "echo 'Acquire::ForceIPv4 \"true\";' > /etc/apt/apt.conf.d/99force-ipv4"
    - travis_retry sudo apt-get -y -qq update
    - travis_retry sudo apt-get install -y -qq software-properties-common python-software-properties
    - travis_retry sudo apt-add-repository -y ppa:octave/stable
    - travis_retry sudo apt-get -y -qq update
    # get Octave 4,0
    - travis_retry sudo apt-get -y -qq install octave liboctave-dev
    # install qMRLab
    - cd ..
    - rm -rf qMRLab
    - git clone https://github.com/qMRLab/qMRLab.git
    # retrieve MOdox
    - rm -rf MOdox
    - travis_retry git clone -v git://github.com/MOdox/MOdox.git
    - make -C MOdox install

script:
    octave --no-gui --eval "addpath('~/git/qMRLab');startup;runtests(pwd, 'Recursively', true)"


